<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>de Bruijn graphs and genomic assembly &#8211; Random Inferences</title>
<meta name="description" content="Post about gibbs sampling method.">
<meta name="keywords" content="machine learning, data science, mathematics, statistics">



<!-- Twitter Cards -->
<meta name="twitter:title" content="de Bruijn graphs and genomic assembly">
<meta name="twitter:description" content="Post about gibbs sampling method.">
<meta name="twitter:site" content="@januverma">
<meta name="twitter:creator" content="@januverma">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://jverma.github.io//images/sample-image-4.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="de Bruijn graphs and genomic assembly">
<meta property="og:description" content="Post about gibbs sampling method.">
<meta property="og:url" content="http://jverma.github.io//debruijn-graphs/">
<meta property="og:site_name" content="Random Inferences">

<meta property="og:image" content="http://jverma.github.io//images/sample-image-4.jpg">






<link rel="canonical" href="http://jverma.github.io//debruijn-graphs/">
<link href="http://jverma.github.io//feed.xml" type="application/atom+xml" rel="alternate" title="Random Inferences Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://jverma.github.io//assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://jverma.github.io//assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://jverma.github.io//assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://jverma.github.io//assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://jverma.github.io//favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://jverma.github.io//favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://jverma.github.io//images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://jverma.github.io//images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://jverma.github.io//images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://jverma.github.io//images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://jverma.github.io//">Random Inferences</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="http://jverma.github.io//about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="http://jverma.github.io//posts/" >Blog</a></li>
				
				    
				        
				    
				    <li><a href="http://jverma.github.io//research/" >Research</a></li>
				
				    
				        
				    
				    <li><a href="http://jverma.github.io//Code/" >Code</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img src=
    
      "http://jverma.github.io//images/sample-image-4.jpg"
    
  alt="de Bruijn graphs and genomic assembly feature image">
  
    <span class="image-credit">Photo Credit: <a href="http://wegraphics.net/downloads/free-ultimate-blurred-background-pack/">WeGraphics</a></span>
  
  </div><!-- /.image-wrap -->


<div id="main" role="main">
  <div class="article-author-side">
    


<div itemscope itemtype="http://schema.org/Person">


	<img src="http://jverma.github.io//images/IMG_20141123_115642.jpg" class="bio-photo" alt="Janu Verma bio photo">


  <h3 itemprop="name">Janu Verma</h3>
  <p>Research Engineer at IBM T.J. Watson Research Center.</p>
  <a href="mailto:j.verma5@gmail.com" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/januverma" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  <a href="http://facebook.com/janu.verma" class="author-social" target="_blank"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a>
  
  <a href="http://linkedin.com/in/janu-verma-b79b8823" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  <a href="http://instagram.com/jverma" class="author-social" target="_blank"><i class="fa fa-fw fa-instagram"></i> Instagram</a>
  <a href="http://januverma.tumblr.com" class="author-social" target="_blank"><i class="fa fa-fw fa-tumblr-square"></i> Tumblr</a>
  <a href="http://github.com/Jverma" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://jverma.github.io//debruijn-graphs/" rel="bookmark" title="de Bruijn graphs and genomic assembly">de Bruijn graphs and genomic assembly</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>Current genome sequencing technology (especially NGS) can sequence only short fragments of DNA. Generally, many copies of a region are sequenced to reduce the sequencing errors. The date from such sequencers, which is in form of short DNA sequence, needs to be assembled to obtain the complete genome. One of the modern methods to assemble the reads data is to use de Bruijn graphs.
<br><br>
<strong>Definition:</strong> Given a sequence of characters, it’s <strong>k−dimensional de Bruijn graph</strong> is defined as follows :
- The nodes are all the subsequences of length k, called <em>k-mers</em>.
- An edge between two nodes is the subsequence of length k + 1 which has the first node as prefix and the second as suffix.
<br><br>
e.g. For S = AGATAC, the 3-de Bruijn of S will have</p>

<ul>
<li>nodes - AGA,GAT,ATA,TAC</li>
<li>edges - AGAT,GATA,ATAC</li>
</ul>

<p><strong>Observation:</strong> There exist \( n^k \) k-mers in an alphabet containing n characters.
<br>
This implies that for English alphabet, we have 17576 3-mers. For DNA sequences the alphabet consists of 4 nucleotides A,G,T,C and thus there are 64 possible 3-mers.
<br>
A k-mer can appear more than one times in a de Bruijn graph with edges to different nodes.
<br><br>
<strong>Definition:</strong> A <strong>Hamiltonian path</strong> in a graph is a path that travels to every nodes exactly once.In the above example, a Hamiltonian path is given by
<br>
AGA -&gt; GAT -&gt; ATA -&gt; TAC.
<br><br>
It is easy to convince yourself that a Hamiltonian path in a de-Brujn graph constructed from the reads data will be a candidate for genome assembly because it visits each detected k-mer. Moreover, it will be the minimum length assembly as it travels to each node exactly one.
Unfortunately, there is no efficient algorithm to compute the Hamiltonian path in a large graph. In fact,
<br>
<strong>Theorem:</strong> Finding a Hamiltonian path in a graph is NP-Complete.
<br><br>
<strong>Definition:</strong> An <strong>Eulerian path</strong> in a graph is a path that visits each edge exactly once. In the above example, an Eulerian path is given by
<br>
AGAT -&gt; GATA -&gt; ATAC
<br><br>
An Eulerian path in a de Bruijn graph constructed on the sequence reads will also give a reasonable genome assembly as it visits each detected k + 1-mer. On the question of existence of an Eulerian path, we have following theorem of Euler -
<br>
<strong>Theorem:</strong> A directed connected graph (one there exists a path between any two nodes) has an Eulerian cycle if and only if the indegree (number of edges leading into the node) of each node is equal to its outdegree (number of edges leaving the node).
<br><br>
<strong>Lemma:</strong> de Bruijn graph has an Eulerian cycle.
<br>
<strong>proof:</strong> For any node, both the indegree and the outdegree are equal to the number of times the k-mer assigned node occurs in the sequence.
<br><br>
Having established that the de Bruijn graph has an Eulerian cycle, the next question is whether we can compute it efficiently. There are algorithms to compute the Eulerian cycle of a graph which are linear in number of edges.
<br><br>
<strong>Algorithm to assmeble genome:</strong></p>

<ul>
<li>Choose the size of k-mers.</li>
<li>Generate all k-mers from the reads data.</li>
<li>Build a de Bruijn graph with k-mers as nodes and connected (k + 1)-mers as edges.</li>
<li>Compute the Eulerian path of the de Bruijn graph- This will be a candidate assmebly.</li>
</ul>

<p><br><br>
Below is an example of genome assembly using de Bruijn graphs - 
<br><br>
<figure>
<img src="https://januverma.files.wordpress.com/2014/11/nbt-2023-f3.gif?w=300"/>
<br><br>
Most of the times, sequencing doesn’t give us all the data. We have a lot of missing data which represent gaps in the genome and in that case, it would be impossible to obtain a whole genome assembly. So we build many de Bruijn graphs and obtain Eulerian cycles. Such cycles represent contiguous sequences of nucleotides, called <strong>contigs</strong>. Sometimes we join contigs separated by gaps to obtain <strong>scaffolds</strong>.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://jverma.github.io//debruijn-graphs/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://jverma.github.io//debruijn-graphs/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://jverma.github.io//debruijn-graphs/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>de Bruijn graphs and genomic assembly</strong> was published on <time datetime="2015-05-16T00:00:00-04:00">May 16, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://jverma.github.io//posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://jverma.github.io//manifold-learning/" title="Manifold learning: Introduction">Manifold learning: Introduction</a></li>
    
      <li><a href="http://jverma.github.io//bloom-filter/" title="Bloom Filters">Bloom Filters</a></li>
    
      <li><a href="http://jverma.github.io//community-in-graphs/" title="Community Detection in networks">Community Detection in networks</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Janu Verma. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>
<span>
	Subscribe to <strong><a href="http://jverma.github.io/feed.xml"></a>RSS Feed</strong>.
</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://jverma.github.io//assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://jverma.github.io//assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-71200371-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'JVerma'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





</body>
</html>
